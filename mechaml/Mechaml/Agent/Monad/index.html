<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Monad (mechaml.Mechaml.Agent.Monad)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">mechaml</a> &#x00BB; <a href="../../index.html">Mechaml</a> &#x00BB; <a href="../index.html">Agent</a> &#x00BB; Monad</nav><h1>Module <code>Agent.Monad</code></h1></header><dl><dt class="spec type" id="type-m"><a href="#type-m" class="anchor"></a><code><span class="keyword">type </span>'a m</code><code><span class="keyword"> = </span><a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="../index.html#type-t">t</a><span class="keyword"> * </span><span class="type-var">'a</span>) Lwt.t</code></dt></dl><dl><dt class="spec value" id="val-bind"><a href="#val-bind" class="anchor"></a><code><span class="keyword">val </span>bind : <span class="type-var">'a</span> <a href="index.html#type-m">m</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a>) <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-return"><a href="#val-return" class="anchor"></a><code><span class="keyword">val </span>return : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-return_from_lwt"><a href="#val-return_from_lwt" class="anchor"></a><code><span class="keyword">val </span>return_from_lwt : <span class="type-var">'a</span> Lwt.t <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val </span>map : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val </span>run : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a><span class="keyword"> * </span><span class="type-var">'a</span></code></dt></dl><aside><p>Wrappers of Lwt's fail functions</p></aside><dl><dt class="spec value" id="val-fail"><a href="#val-fail" class="anchor"></a><code><span class="keyword">val </span>fail : exn <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-fail_with"><a href="#val-fail_with" class="anchor"></a><code><span class="keyword">val </span>fail_with : string <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></dt></dl><aside><p>Wrappers of <code>Lwt.catch</code> and <code>Lwt.try_bind</code> inside this monad</p></aside><dl><dt class="spec value" id="val-catch"><a href="#val-catch" class="anchor"></a><code><span class="keyword">val </span>catch : (unit <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a>) <span>&#45;&gt;</span> (exn <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-try_bind"><a href="#val-try_bind" class="anchor"></a><code><span class="keyword">val </span>try_bind : (unit <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a>) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a>) <span>&#45;&gt;</span> (exn <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a>) <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a></code></dt></dl><dl><dt class="spec module" id="module-Infix"><a href="#module-Infix" class="anchor"></a><code><span class="keyword">module </span><a href="Infix/index.html">Infix</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The Infix module defines operators for common bind operations</p></dd></dl><dl><dt class="spec module" id="module-List"><a href="#module-List" class="anchor"></a><code><span class="keyword">module </span><a href="List/index.html">List</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The List module wraps the functions of the Lwt_list module inside the Agent monad. Functions suffixed with _s chain the actions sequentially, passing around the updated agent from an action to the next one. The functions suffixed with _m do everything in parallel, using a copy of the initial state in every thread and returning this same original state. The latter can be useful to retrieve a bunch of resources in batch where the updated state is not of interest (e.g download images)</p></dd></dl><aside><p>Get the current state of the agent, or set a new one</p></aside><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val </span>get : <a href="../index.html#type-t">t</a> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val </span>set : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt></dl><aside><p>Wrap the type of functions operating on the agent such as <a href="../index.html#val-cookie_jar"><code>Agent.cookie_jar</code></a> or <a href="../index.html#val-set_cookie_jar"><code>Agent.set_cookie_jar</code></a> to be usable inside the monad. For example, the first one go from <code>Agent.t -&gt; Cookiejar.t</code> to <code>Agent.t -&gt; (Agent.t * Cookiejar.t) Lwt.t</code> by just returning the agent unmodified together with the current cookie jar and wrap the result through <code>Lwt.return</code></p><p>Note that the redefined functions have the same name as their counterpart, and thus will shadow or can be shadowed by them.</p></aside><dl><dt class="spec value" id="val-save_content"><a href="#val-save_content" class="anchor"></a><code><span class="keyword">val </span>save_content : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-cookie_jar"><a href="#val-cookie_jar" class="anchor"></a><code><span class="keyword">val </span>cookie_jar : <a href="../../Cookiejar/index.html#type-t">Cookiejar.t</a> <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-set_cookie_jar"><a href="#val-set_cookie_jar" class="anchor"></a><code><span class="keyword">val </span>set_cookie_jar : <a href="../../Cookiejar/index.html#type-t">Cookiejar.t</a> <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-add_cookie"><a href="#val-add_cookie" class="anchor"></a><code><span class="keyword">val </span>add_cookie : <a href="../../Cookiejar/Cookie/index.html#type-t">Cookiejar.Cookie.t</a> <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-remove_cookie"><a href="#val-remove_cookie" class="anchor"></a><code><span class="keyword">val </span>remove_cookie : <a href="../../Cookiejar/Cookie/index.html#type-t">Cookiejar.Cookie.t</a> <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-client_headers"><a href="#val-client_headers" class="anchor"></a><code><span class="keyword">val </span>client_headers : Cohttp.Header.t <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-set_client_headers"><a href="#val-set_client_headers" class="anchor"></a><code><span class="keyword">val </span>set_client_headers : Cohttp.Header.t <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-add_client_header"><a href="#val-add_client_header" class="anchor"></a><code><span class="keyword">val </span>add_client_header : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-remove_client_header"><a href="#val-remove_client_header" class="anchor"></a><code><span class="keyword">val </span>remove_client_header : string <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt><dt class="spec value" id="val-set_max_redirect"><a href="#val-set_max_redirect" class="anchor"></a><code><span class="keyword">val </span>set_max_redirect : int <span>&#45;&gt;</span> unit <a href="index.html#type-m">m</a></code></dt></dl></div></body></html>